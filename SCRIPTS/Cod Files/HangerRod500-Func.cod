function ChangeRodLength()
    select item.CID
        case 838
            dim i
            for i =  1 to item.dims
                select item.Dim[i].Name
                    case "Rod Length", "Rod Extn Above"
                        item.Dim[i].Value = RoundLength(item.Dim[i].Value)
                end select
            next
        end select
end function

function RoundLength(length)
    dim length = item.dim[7].numvalue
 Rem debug length
dim dval = Instr(1,length,".") + 1
 Rem debug "dval "+dval
dim wnum = left(length, dval-2)
 Rem debug "wnum "+wnum
dim dnum = mid(length, dval, 1)
 rem debug "dnum "+dnum
Dim newdec =""
dim dec0 = ".0000"
dim dec25 = ".2500"
dim dec50 = ".5000"
dim dec75 = ".7500"




 if dnum=0 or dnum=1 or dnum=2 then
  item.dim[7].value = wnum + dec0
 endif

 if dnum=3 or dnum=4 or dnum=5 or dnum=6 then
  item.dim[7].value = wnum + dec50
 endif


 if dnum=7 or dnum=8 or dnum=9 then
 item.dim[7].value = roundup(length)
 endif 
end function

ChangeRodLength()

