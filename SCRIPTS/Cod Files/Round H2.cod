rem spiral & rolled pipe
select item.cid
  case 838
   dim length = item.dim[7].value
   dim i = item.dim[7].numvalue
   dim rln = round(i,2)
   dim result = rounddown(i,0)
   dim lo = rln-result
   dim quote1 = ASCII(34)
   dim quote2 = ASCII(47)
   dim quote3 = ASCII(32)

rem Setion to correct length
    if lo>0.875 then
       result = result+1
      elseif lo>0.625 then
             result = result+0.75
        elseif lo>0.375 then
               result = result+0.5
          elseif lo>0.125 then
                 result = result+0.25
            else result = result
    endif
 
    length=result

 
 item.dim[7].value=length
 item.update()
end select


Rem http://www.xtracad.com/forum/index.php/topic,10083.msg68269.html#msg68269