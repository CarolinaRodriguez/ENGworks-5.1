
Dim Min1pcCoil = 6
DIM Max1pcCoil = 60
DIM Max2pcCoil = 120
DIM MaxFoldCoil = 48

DIM Max1pcCut = 60
DIM Max2pcCut = 60
DIM LinerWrapCut = "Yes"







Rem Process Coiled Duct
If Item.cid = 866 and Item.cuttype = "Decoiled Straight" then
Dim Stretchout = (Item.dim["Width"].numvalue + Item.dim["Depth"].numvalue)*2
Dim HalfStretchout = Item.dim["Width"].numvalue + Item.dim["Depth"].numvalue
  If item.insulation.Status = "Inside" then
    If LinerWrapCoil = "Yes" and Stretchout < Max1pcCoil then
    Item.option["Override"].value = "1 Part Straight"
    else
      if HalfStretchout < Max2pcCoil then
      item.option["Override"].value = "2xL"
      else
      item.option["Override"].value = "4xI,M-F"
      endif
    Endif
  Else
    if stretchout < max1pccoil then
     Item.option["Override"].value = "1 Part Straight"
    else
      if HalfStretchout < Max2pcCoil then
      item.option["Override"].value = "2xL"
      else
      item.option["Override"].value = "4xI,M-F"
      endif
    Endif
  Endif
  if  item.option["Override"].value = "2xL" then
    if item.dim["Width"].numValue > MaxFoldCoil or item.dim["Depth"].numValue > MaxFoldCoil then
      item.option["Override"].value = "4xI,M-F"
    Endif
  Endif
Endif

Rem Process Coiled Duct SS Fold
If Item.cid = 866 and Item.cuttype = "Decoiled Straight" then
 if item.dim["Width"].numvalue < Min1pcCoil Then
    item.option["Override"].value = "2xL"
 Endif
 if item.dim["Depth"].numvalue < Min1pcCoil Then
     item.option["Override"].value = "2xL"
 Endif
Endif

Rem Process machine Cut Duct
If Item.cid = 866 and Item.cuttype = "Machine Cut" then
Dim Stretchout = (Item.dim["Width"].numvalue + Item.dim["Depth"].numvalue)*2
Dim HalfStretchout = Item.dim["Width"].numvalue + Item.dim["Depth"].numvalue
  If item.insulation.Status = "Inside" then
    If LinerWrapCut = "Yes" and Stretchout < Max1pcCut then
    Item.option["Override"].value = "1 Part Straight"
    else
      if HalfStretchout < Max2pcCut then
      item.option["Override"].value = "2xL"
      else
      item.option["Override"].value = "4xI,M-M,F-F"
      endif
    Endif
  Else
    if stretchout < max1pccut then
     Item.option["Override"].value = "1 Part Straight"
    else
      if HalfStretchout < Max2pcCut then
      item.option["Override"].value = "2xL"
      else
      item.option["Override"].value = "4xI,M-M,F-F"
      endif
    Endif
  Endif
Endif

Item.update()