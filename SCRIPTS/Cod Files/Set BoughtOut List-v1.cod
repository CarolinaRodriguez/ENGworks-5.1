requires task.selection
 dim delim = ","
 dim ret = ASCII(13)



Rem Check for valid OpCo Number in job info
Rem Reading JobInfo OpCo Number
Dim TargetOpco = trim(job.customdata["OpCo Number"].Value)

If TargetOpCo < 0 Then
    dim UsrOpCoNumber = inputbox("Enter OpCo Number")
    Job.customdata["OpCo Number"].value = UsrOpCoNumber
 Endif

 dim BoughtOutPar =  MapPath_Scripts + "\OpCoBoughtOut\" + TargetOpco + "-OpCoBoughtOut-v1.csv"

rem *** Create the file and verify it is open
object outfile = new file(BoughtOutPar, forinput+foroutput+istext)


 
if outfile.isopen then

 rem *** write headers
 outfile.writeline("ItemName" + delim + "BoTrue")
 
 dim i = 1
  while i <= task.selection.count
  dim item = task.selection[i]
  dim lineStr = ""
  

  If TargetOpCo > 0 Then
    dim ItemName = Item.filename
    lineStr = (lineStr + ItemName + delim + "Yes")
    rem while not outfile.eof
    rem Dim ItemList =outfile.readline()

    rem if ((ItemList) <> (LineStr)) then
      outfile.position = file_end
      outfile.writeline(lineStr)
    rem endif
    rem end while
  Endif

 i = i + 1
 end while
endif
outfile.close()
task.endprogress()