
requires task.selection

dim RH = inputbox("Enter Rod Finished Height")

dim i = 1

while i <= task.selection.count
    dim item = task.selection[i]
If item.CID = 838 Then
rem debug item.dim["Rod Extn Above"].value
   if item.option["Type"].value = "Clevis Hanger" Then
   dim RA = item.dim["Rod Extn Above"].numvalue
   dim dia = item.endlocation(1, "top") - item.endlocation(1, "z")
   dim ton = item.endlocation(1, "z") + item.dim["Height"].numvalue - dia
   dim tor = item.dim["Rod Extn Above"].numvalue
   Rem dim uel = 200.0
   dim cel = ton + tor
   dim nel = RH - cel
   dim RL= RA + nel
   item.dim[7].value = RL
  if item.dim["Rod Extn Above"].numvalue < 0.0 then
  item.dim["Rod Extn Above"].numvalue = 0
   endif
  endif
endif
  i = i + 1
end while