requires task.selection
dim loop = 1
Dim hangerqt = 0

dim a = ""
dim b = ""
dim c = ""
dim d = ""
dim z = ""
dim z1 = ""
dim f = ""
dim hqty = ""
dim finalnum = ""
dim myarrayPL as array


loop = 1
while loop <= task.selection.count
dim mysetPL = task.selection[loop]
dim PL1 = mysetPL.servicetype
if wildcard(PL1, "HANGER") then
myarrayPL.add(mysetPL)
hangerqt = hangerqt + 1
end if
loop = loop + 1
endwhile

loop = 1

while loop <= task.selection.count
dim item = task.selection[loop]

If item.cid = 2041 then

 A = item.dim[1].numvalue / 2
 B = A*A*3.14159
 C = item.dim[2].numvalue * B
 D = C / 231
 Z = D * 8.33
 Z1 = item.weight*( item.dim[2].numvalue/12)
 F = Z+Z1
 hqty =  item.qty
finalnum = round(F / hangerqt,0)



rem debug "Weight per hanger FROM THE PIPE " + finalnum
end if
loop = loop + 1
endwhile


loop = 1
while loop<=myarrayPL.count
dim mysetPL = myarrayPL[loop]

rem debug "Weight per hangerIN THE HANGER ITM " + finalnum

mysetPL.option["Point Load A"].value=finalnum
mysetPL.option["Point Load B"].value=finalnum


loop = loop + 1
endwhile
