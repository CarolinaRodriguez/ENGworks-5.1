requires task.selection
dim ret = ascii(10)
dim i = 1
dim matIndex = 1
dim imStr = ""
dim insulMats as array

rem ### This part grabs all insulation materials for selected items and
rem ### puts them in an array (insulMats)
while i <= task.selection.count
	dim item = task.selection[i]
	dim im = item.insulation.material
	dim addMat = true
	for matIndex = 1 to insulMats.count
		if im = insulMats[matIndex] then
			addMat = false
		endif
	next
	if addMat then
		insulMats.add(im)
	endif
	i = i +1
end while

rem ### Adds the materials to a string for selection in the input box
for i = 1 to insulMats.count
	imStr = imStr + i + ") " + insulMats[i] + ret
next
dim indexToChange = inputbox("Input index to change:" + ret + ret + imStr, "Change Insulation Material", "")
dim oldInsMat = insulMats[indexToChange]

dim newInsMat = inputbox("Change all '" + oldInsMat + "' insulation material to:", "New Insulation Material", "")

rem ### Here we change the "old" material value to the "new" one
i = 1
while i <= task.selection.count
	dim item = task.selection[i]
	dim im = item.insulation.material
	if im = oldInsMat then
		item.insulation.materiallock = false
		item.insulation.material = newInsMat		
		item.insulation.materiallock = true
        item.update()
	endif
	i = i +1
end while
