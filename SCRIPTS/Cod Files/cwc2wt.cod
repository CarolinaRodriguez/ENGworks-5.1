requires task.selection
dim i = 1
dim matIndex = 1
dim CSMats as array

rem ### This part grabs all insulation materials for selected items and
rem ### puts them in an array (insulMats)
while i <= task.selection.count
	dim item = task.selection[i]
	dim im = item.material
	dim addMat = true
	for matIndex = 1 to CSMats.count
		if im = CSMats[matIndex] then
			addMat = false
		endif
	next
	if addMat then
		CSMats.add(im)
	endif
	i = i +1
end while


dim CS = inputbox("Input index to change:" + ret + ret + imStr, "Change Insulation Material", "")
dim oldInsMat = insulMats[indexToChange]

dim newInsMat = inputbox("Change all '" + oldInsMat + "' insulation material to:", "New Insulation Material", "")

rem ### Here we change the "old" material value to the "new" one
i = 1
while i <= task.selection.count
	dim item = task.selection[i]
	dim im = item.insulation.material
	if im = oldInsMat then
		item.insulation.materiallock = false
		item.insulation.material = newInsMat		
		item.insulation.materiallock = true
        item.update()
	endif
	i = i +1
end while
