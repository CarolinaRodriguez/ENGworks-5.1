requires task.selection

dim i = 1

while i <= task.selection.count
  dim item = task.selection[i]
 If item.cid = 2041 Then
  if item.endlocation(1,"btm") = item.endlocation(2,"btm") then
    Dim BopElev = item.endlocation(1,"btm")
    Dim TOPElev = item.endlocation(1,"top")
    Dim OD = (TopElev - BopElev)
    Item.customdata["PipeOD"].numvalue = OD
    item.update()
  Endif
 Endif

      i = i + 1
end while
