Rem Check for valid OpCo Number in job info
dim StiffPar =  MapPath_Scripts + "\Parameter-v2\Stiffeners-v1.csv"
dim delimiter = ","

Rem Column Headers from Stiffeners-v1.csv
Rem Stiffener Parameters
 Rem Col-1
 Dim StiffName
Rem Col-2
Dim Lnum
 Rem Col-3
 Dim Snum
Rem Col-4
Dim StiffDesc
 Rem Col-5
 Dim StiffCol5
Rem Col-6
Dim StiffCol6



requires task

dim StiffFile as file(StiffPar, forinput + istext)
if StiffFile.isopen then

  task.beginprogress(StiffFile.length)

 rem debug "Stiffener File Opened"
endif
 
Rem debug "StiffPar File Opened"
 
  while not StiffFile.eof and not task.aborted

    task.progress = StiffFile.position
 
      dim initialentry=StiffFile.readline()
      dim entry = ""
      entry = initialentry + ","

    dim c = instr( 1, entry, delimiter )
    if c>1 then
      StiffName = substring(entry, 1, c-1)
      StiffName = trim(StiffName)
    endif
       rem debug StiffName

 dim c2 = instr(c+1, entry, delimiter)
  if c2>c+1 then
 Snum=substring(entry, c+1, c2-1)
 Snum=Trim(Snum)
 Endif

dim c3 = instr(c2+1, entry, delimiter)
  if c3>c2+1 then
 Lnum=substring(entry, c2+1, c3-1)
 Lnum=Trim(Lnum)
 Endif

dim c4 = instr(c3+1, entry, delimiter)
  if c4>c3+1 then
 StiffDesc=substring(entry, c3+1, c4-1)
 StiffDesc=Trim(StiffDesc)
 Endif

dim c5 = instr(c4+1, entry, delimiter)
  if c5>c4+1 then
 StiffCol5=substring(entry, c4+1, c5-1)
 StiffCol5=Trim(StiffCol5)
 Endif

dim c6 = instr(c5+1, entry, delimiter)
  if c6>c5+1 then
 StiffCol6=substring(entry, c5+1, c6-1)
 StiffCol6=Trim(StiffCol6)
 Endif







if Item.library = "Rectangular" then
 Dim Width = Item.dim[1].numvalue
 Dim Depth = Item.dim[2].numvalue
  if item.Stiffeners > 0 then
  Dim StifVal = Item.Stiffener[1].Value
   if (stifVal = stiffname and (width > Snum and Width <=Lnum)) then
    Item.customdata["Stif Width"].value = stiffdesc
   Endif
   if (stifVal = stiffname and (Depth > Snum and Depth <=Lnum)) then
    Item.customdata["Stif Depth"].value = stiffdesc
   Endif
  Endif
Endif

endwhile

item.update()

task.endprogress()

Item.update()