dim quote = ascii(34)

rem will add a temporary file to move object when input is correct. 
dim elevationChangeFile = "C:\Autodesk Fabrication\ENGworks V5.0\SCRIPTS\mapelevmove.lsp"

object f = new file(elevationChangeFile, FOROUTPUT+ISTEXT)
f.position = FILE_END

rem gets the necessary item information for moving an item.
dim btm = item.endlocation(1,"Btm")
dim section = item.level("floor")
dim elev = number(btm-section)
dim mixedI = number(elev/12)
dim pt = instr(1,mixedI,".")
dim len = len(mixedI)
dim getin = right(mixedI,(len-pt)+1)
dim in = (number(getin)*12)
	in = round(in,2)
dim ft = left(mixedI,pt-1)

	dim BtmElev = ft + "'-" + in + quote
	dim ElevChange
rem inputbox section of code for entering new elevations.
ElevChange = inputbox("Enter new Bottom Elev","Elevation change",BtmElev)
    dim ftSym = instr(1,ElevChange,"'")
    dim inSym = instr(1,ElevChange,quote)
    dim dshSym = instr(1,ElevChange,"-")
    dim elevFt = left(ElevChange,ftSym-1)
    dim elevIn = mid(ElevChange,dshSym+1,(inSym-dshSym)-1)
    dim FttoIn = (number(elevFt)*12)
    dim totalIn = ((number(FttoIn))+(number(elevIn)))
    dim elevDiff
rem gets the elevation difference so that the lisp can move the selected item.
	elevDiff = (((number(totalIn)) + item.level("floor")) - item.endlocation(1,"Btm"))

rem writes the lisp file to run when loaded.
if f.isopen then
  f.writeline("(command" + """move"" " + """p"" " + """"" " + """"" " + """@0,0," + (number(elevDiff)) + """)")
  f.close()
end if